<!DOCTYPE html><html><head><title>scala-server-toolkit: PureConfig</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Avast" /><meta name="description" content="Functional programming toolkit for building server applications in Scala." /><meta name="og:image" content="/scala-server-toolkit/img/poster.png" /><meta name="image" property="og:image" content="/scala-server-toolkit/img/poster.png" /><meta name="og:title" content="scala-server-toolkit: PureConfig" /><meta name="title" property="og:title" content="scala-server-toolkit: PureConfig" /><meta name="og:site_name" content="scala-server-toolkit" /><meta name="og:url" content="https://github.com/avast/scala-server-toolkit" /><meta name="og:type" content="website" /><meta name="og:description" content="Functional programming toolkit for building server applications in Scala." /><link rel="icon" type="image/png" href="/scala-server-toolkit/img/favicon.png" /><meta name="twitter:title" content="scala-server-toolkit: PureConfig" /><meta name="twitter:image" content="https://avast.github.io/scala-server-toolkit/img/poster.png" /><meta name="twitter:description" content="Functional programming toolkit for building server applications in Scala." /><meta name="twitter:card" content="summary_large_image" /><meta name="twitter:site" content="@avast_devs" /><link rel="icon" type="image/png" sizes="16x16" href="/scala-server-toolkit/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/scala-server-toolkit/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/scala-server-toolkit/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/scala-server-toolkit/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/scala-server-toolkit/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/scala-server-toolkit/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/scala-server-toolkit/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/scala-server-toolkit/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/scala-server-toolkit/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/scala-server-toolkit/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/scala-server-toolkit/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/scala-server-toolkit/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/scala-server-toolkit/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/scala-server-toolkit/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/scala-server-toolkit/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/scala-server-toolkit/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/scala-server-toolkit/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/scala-server-toolkit/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/scala-server-toolkit/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/scala-server-toolkit/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/scala-server-toolkit/highlight/styles/github.css" /><link rel="stylesheet" href="/scala-server-toolkit/css/pattern-style.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/scala-server-toolkit/" class="brand"><div class="brand-wrapper"><span>scala-server-toolkit</span></div></a></li> <li><a href="/scala-server-toolkit/getting-started" class="">Getting Started</a></li> <li><a href="/scala-server-toolkit/rationale" class="">Rationale</a></li> <li><a href="/scala-server-toolkit/structure" class="">Structure</a></li> <li><a href="/scala-server-toolkit/bundles" class="">Bundles</a></li> <li><a href="/scala-server-toolkit/subprojects" class="">Subprojects</a> <ul class="sub-section"> <li><a href="/scala-server-toolkit/subprojects/http4s" class="">http4s</a></li> <li><a href="/scala-server-toolkit/subprojects/jvm" class="">JVM</a></li> <li><a href="/scala-server-toolkit/subprojects/micrometer" class="">Micrometer</a></li> <li><a href="/scala-server-toolkit/subprojects/pureconfig" class=" active ">PureConfig</a></li> <li><a href="/scala-server-toolkit/subprojects/cassandra-datastax-driver" class="">Datastax Cassandra Driver</a></li> <li><a href="/scala-server-toolkit/subprojects/fs2-kafka" class="">FS2 Kafka</a></li> <li><a href="/scala-server-toolkit/subprojects/ssl-config" class="">SSL Config</a></li> <li><a href="/scala-server-toolkit/subprojects/doobie" class="">doobie</a></li> <li><a href="/scala-server-toolkit/subprojects/flyway" class="">Flyway</a></li> <li><a href="/scala-server-toolkit/subprojects/monix-catnap" class="">monix-catnap - Circuit Breaker</a></li> <li><a href="/scala-server-toolkit/subprojects/sentry" class="">Sentry</a></li> <li><a href="/scala-server-toolkit/subprojects/lettuce" class="">Lettuce (Redis)</a></li></ul></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li class="search-nav hidden-xs hidden-sm"><div id="search-dropdown"><label><i class="fa fa-search"></i>Search</label><input id="search-bar" type="text" placeholder="Enter keywords here..." onclick="displayToggleSearch(event)" /><ul id="search-dropdown-content" class="dropdown dropdown-content"></ul></div></li><li id="gh-eyes-item" class="hidden-xs to-uppercase"><a href="https://github.com/avast/scala-server-toolkit" target="_blank" rel="noopener noreferrer"><i class="fa fa-eye"></i><span>Watchers<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs to-uppercase"><a href="https://github.com/avast/scala-server-toolkit" target="_blank" rel="noopener noreferrer"><i class="fa fa-star-o"></i><span>Stars<span id="stars" class="label label-default">--</span></span></a></li></ul></div></div></div></div><div id="content" data-github-owner="avast" data-github-repo="scala-server-toolkit"><div class="content-wrapper"><section><h1 id="pureconfig">PureConfig</h1>

<p><code class="highlighter-rouge">libraryDependencies += "com.avast" %% "sst-pureconfig" % "0.18.4"</code></p>

<p>This subproject allows you to load your application’s configuration file into a case class. It uses <a href="https://pureconfig.github.io">PureConfig</a> 
library to do so. PureConfig uses <a href="https://github.com/lightbend/config">Lightbend Config</a> which means that your application’s configuration 
will be in <a href="https://github.com/lightbend/config/blob/master/HOCON.md">HOCON</a> format.</p>

<p>Loading of a configuration is effectful, so it is wrapped in <code class="highlighter-rouge">F[_]</code> which is <code class="highlighter-rouge">Sync</code>. This module also tweaks the error messages a little.</p>

<h2 id="usage-and-typeclass-derivation">Usage and typeclass derivation</h2>
<p>Unfortunately there are some incompatible changes between Scala 2 and Scala 3 series of PureConfig when it comes to typeclass derivation. We’ve created different implementation for each series in order to unblock migration to Scala 3 for SST users. Read on for further details on usage of each.</p>

<h3 id="scala-2">Scala 2</h3>

<p>Sample usage:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">com.avast.sst.pureconfig.PureConfigModule</span>
<span class="k">import</span> <span class="nn">pureconfig.ConfigReader</span>
<span class="k">import</span> <span class="nn">pureconfig.generic.semiauto.deriveReader</span>
<span class="k">import</span> <span class="nn">zio.interop.catz.</span><span class="o">*</span>
<span class="k">import</span> <span class="nn">zio.Task</span>

<span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">ServerConfiguration</span><span class="o">(</span><span class="n">listenAddress</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">listenPort</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span>

<span class="k">implicit</span> <span class="k">val</span> <span class="nv">serverConfigurationReader</span><span class="k">:</span> <span class="kt">ConfigReader</span><span class="o">[</span><span class="kt">ServerConfiguration</span><span class="o">]</span> <span class="k">=</span> <span class="n">deriveReader</span>

<span class="k">val</span> <span class="nv">maybeConfiguration</span> <span class="k">=</span> <span class="nv">PureConfigModule</span><span class="o">.</span><span class="py">make</span><span class="o">[</span><span class="kt">Task</span>, <span class="kt">ServerConfiguration</span><span class="o">]</span>
</code></pre></div></div>

<p>We also provide modules with implicits for many of SST modules. Look for <code class="highlighter-rouge">sst-*-pureconfig</code> subprojects to get <code class="highlighter-rouge">implicit</code> instances of <code class="highlighter-rouge">ConfigReader</code> for specific libraries, e.g.:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">com.avast.sst.http4s.server.pureconfig.implicits.</span><span class="o">*</span>
</code></pre></div></div>

<p>The default <code class="highlighter-rouge">*.pureconfig.implicits._</code> import contains the default naming convention for PureConfig which is <code class="highlighter-rouge">kebab-case</code> 
for the configuration file and <code class="highlighter-rouge">camelCase</code> for the case class field names. You can either choose a different naming convention by different
import (e.g. <code class="highlighter-rouge">*.pureconfig.implicits.CamelCase</code>) or you can <a href="https://pureconfig.github.io/docs/overriding-behavior-for-case-classes.html#field-mappings">create your own</a>
and <code class="highlighter-rouge">extend</code> the <code class="highlighter-rouge">ConfigReaders</code> <code class="highlighter-rouge">trait</code>.</p>

<h3 id="scala-3">Scala 3</h3>

<p>Unlike for Scala 2, pureconfig in Scala 3 supports only <code class="highlighter-rouge">kebab-case</code> derivation. This is reflected in the structure of the implicits we provide. The derivation API has also changed. See <a href="https://pureconfig.github.io/docs/scala-3-derivation.html">official docs</a> for more details.</p>

<p>Sample usage:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">com.avast.sst.pureconfig.PureConfigModule</span>
<span class="k">import</span> <span class="nn">pureconfig.ConfigReader</span>
<span class="k">import</span> <span class="nn">zio.interop.catz.</span><span class="o">*</span>
<span class="k">import</span> <span class="nn">zio.Task</span>
<span class="k">import</span> <span class="nn">pureconfig.generic.derivation.default.</span><span class="o">*</span>

<span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">ServerConfiguration</span><span class="o">(</span><span class="n">listenAddress</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">listenPort</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span>

<span class="k">implicit</span> <span class="k">val</span> <span class="nv">serverConfigurationReader</span><span class="k">:</span> <span class="kt">ConfigReader</span><span class="o">[</span><span class="kt">ServerConfiguration</span><span class="o">]</span> <span class="k">=</span> <span class="nv">ConfigReader</span><span class="o">.</span><span class="py">derived</span>

<span class="k">val</span> <span class="nv">maybeConfiguration</span> <span class="k">=</span> <span class="nv">PureConfigModule</span><span class="o">.</span><span class="py">make</span><span class="o">[</span><span class="kt">Task</span>, <span class="kt">ServerConfiguration</span><span class="o">]</span>
</code></pre></div></div>

<h2 id="toggle">Toggle</h2>
<p>Sometimes it is useful to be able to disable some functionality via config. That usually means to add a new boolean field to particular configuration case class. You have to be aware of this new field when you work with the configuration and check the value of it to enable/disable particular functionality.</p>

<p><code class="highlighter-rouge">Toggle</code> is a more safe approach for this pattern as it can be either <code class="highlighter-rouge">Enabled[T]</code> or <code class="highlighter-rouge">Disabled</code>.
So it will force you to deal with the possibility of disabled functionality.
It also simplifies the workflow and particular config case class as it does not require any changes to it.
The boolean flag is build in the <code class="highlighter-rouge">Toggle</code> itself and the value is converted to <code class="highlighter-rouge">Enabled[T]</code> or <code class="highlighter-rouge">Disabled</code>.
For more details please see the example below:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>case class MyConfig(myService: Toggle[ServiceConfig])
case class ServiceConfig(url: String, timeout: Duration)
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>my-service {
    enabled = false
    url = "http://www.example.com/v1/some-endpoint"
    timeout = 5s
}
</code></pre></div></div>

<h2 id="withconfig">WithConfig</h2>
<p>Sometimes you need to load the configuration both as your custom configuration class and raw <code class="highlighter-rouge">Config</code> when you deal with legacy code. Using <code class="highlighter-rouge">WithConfig</code> case class allows you to load both objects simultaneously.</p>

<p>Example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>case class MyConfig(myService: WithConfig[ServiceConfig])
case class ServiceConfig(url: String, timeout: Duration)
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>val serviceConfig: Config = myConfig.myService.config
val urlFromConfig: String = serviceConfig.getString("url")

val serviceConfigCustom: ServiceConfig = myConfig.myService.value
val urlFromCustomObject: String = serviceConfigCustom.url
</code></pre></div></div>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/scala-server-toolkit/highlight/highlight.pack.js"></script><script src="/scala-server-toolkit/lunr/lunr.js"></script><script>
// For all code blocks, copy the language from the containing div
// to the inner code tag (where hljs expects it to be)
const langPrefix = 'language-';
document.querySelectorAll(`div[class^='${langPrefix}']`).forEach(function(div) {
  div.classList.forEach(function(cssClass) {
    if (cssClass.startsWith(langPrefix)) {
      const lang = cssClass.substring(langPrefix.length);
      div.querySelectorAll('pre code').forEach(function(code) {
        code.classList.add(lang);
      });
    }
  });
});

hljs.configure({languages:['scala','java','bash']});
hljs.initHighlightingOnLoad();
      </script><script>console.info('\x57\x65\x62\x73\x69\x74\x65\x20\x62\x75\x69\x6c\x74\x20\x77\x69\x74\x68\x3a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x5f\x20\x20\x20\x20\x5f\x5f\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x20\x5f\x5f\x0a\x20\x20\x20\x5f\x5f\x5f\x5f\x5f\x2f\x20\x2f\x5f\x20\x20\x2f\x20\x2f\x5f\x20\x20\x20\x20\x20\x20\x5f\x5f\x5f\x5f\x20\x5f\x5f\x5f\x20\x20\x28\x5f\x29\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x20\x20\x5f\x5f\x5f\x5f\x5f\x28\x5f\x29\x20\x2f\x5f\x5f\x5f\x5f\x20\x20\x5f\x5f\x5f\x5f\x5f\x0a\x20\x20\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x5c\x2f\x20\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x60\x5f\x5f\x20\x5c\x2f\x20\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x5c\x2f\x20\x5f\x5f\x5f\x2f\x20\x2f\x20\x5f\x5f\x2f\x20\x5f\x20\x5c\x2f\x20\x5f\x5f\x5f\x2f\x0a\x20\x28\x5f\x5f\x20\x20\x29\x20\x2f\x5f\x2f\x20\x2f\x20\x2f\x5f\x2f\x5f\x5f\x5f\x5f\x5f\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x5f\x5f\x2f\x20\x2f\x20\x20\x2f\x20\x2f\x5f\x2f\x20\x28\x5f\x5f\x20\x20\x29\x20\x2f\x20\x2f\x5f\x2f\x20\x20\x5f\x5f\x28\x5f\x5f\x20\x20\x29\x0a\x2f\x5f\x5f\x5f\x5f\x2f\x5f\x2e\x5f\x5f\x5f\x2f\x5c\x5f\x5f\x2f\x20\x20\x20\x20\x20\x2f\x5f\x2f\x20\x2f\x5f\x2f\x20\x2f\x5f\x2f\x5f\x2f\x5c\x5f\x5f\x5f\x2f\x5f\x2f\x20\x20\x20\x5c\x5f\x5f\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x2f\x5f\x2f\x5c\x5f\x5f\x2f\x5c\x5f\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x2f\x0a\x0a\x68\x74\x74\x70\x73\x3a\x2f\x2f\x34\x37\x64\x65\x67\x2e\x67\x69\x74\x68\x75\x62\x2e\x69\x6f\x2f\x73\x62\x74\x2d\x6d\x69\x63\x72\x6f\x73\x69\x74\x65\x73')</script><script src="/scala-server-toolkit/js/search.js"></script><script src="/scala-server-toolkit/js/main.js"></script></body></html>