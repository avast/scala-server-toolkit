<!DOCTYPE html><html><head><title>scala-server-toolkit: FS2 Kafka</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Avast" /><meta name="description" content="Functional programming toolkit for building server applications in Scala." /><meta name="og:image" content="/scala-server-toolkit/img/poster.png" /><meta name="image" property="og:image" content="/scala-server-toolkit/img/poster.png" /><meta name="og:title" content="scala-server-toolkit: FS2 Kafka" /><meta name="title" property="og:title" content="scala-server-toolkit: FS2 Kafka" /><meta name="og:site_name" content="scala-server-toolkit" /><meta name="og:url" content="https://github.com/avast/scala-server-toolkit" /><meta name="og:type" content="website" /><meta name="og:description" content="Functional programming toolkit for building server applications in Scala." /><link rel="icon" type="image/png" href="/scala-server-toolkit/img/favicon.png" /><meta name="twitter:title" content="scala-server-toolkit: FS2 Kafka" /><meta name="twitter:image" content="https://avast.github.io/scala-server-toolkit/img/poster.png" /><meta name="twitter:description" content="Functional programming toolkit for building server applications in Scala." /><meta name="twitter:card" content="summary_large_image" /><meta name="twitter:site" content="@avast_devs" /><link rel="icon" type="image/png" sizes="16x16" href="/scala-server-toolkit/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/scala-server-toolkit/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/scala-server-toolkit/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/scala-server-toolkit/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/scala-server-toolkit/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/scala-server-toolkit/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/scala-server-toolkit/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/scala-server-toolkit/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/scala-server-toolkit/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/scala-server-toolkit/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/scala-server-toolkit/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/scala-server-toolkit/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/scala-server-toolkit/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/scala-server-toolkit/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/scala-server-toolkit/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/scala-server-toolkit/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/scala-server-toolkit/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/scala-server-toolkit/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/scala-server-toolkit/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/scala-server-toolkit/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/scala-server-toolkit/highlight/styles/github.css" /><link rel="stylesheet" href="/scala-server-toolkit/css/pattern-style.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/scala-server-toolkit/" class="brand"><div class="brand-wrapper"><span>scala-server-toolkit</span></div></a></li> <li><a href="/scala-server-toolkit/getting-started" class="">Getting Started</a></li> <li><a href="/scala-server-toolkit/rationale" class="">Rationale</a></li> <li><a href="/scala-server-toolkit/structure" class="">Structure</a></li> <li><a href="/scala-server-toolkit/bundles" class="">Bundles</a></li> <li><a href="/scala-server-toolkit/subprojects" class="">Subprojects</a> <ul class="sub-section"> <li><a href="/scala-server-toolkit/subprojects/http4s" class="">http4s</a></li> <li><a href="/scala-server-toolkit/subprojects/jvm" class="">JVM</a></li> <li><a href="/scala-server-toolkit/subprojects/micrometer" class="">Micrometer</a></li> <li><a href="/scala-server-toolkit/subprojects/pureconfig" class="">PureConfig</a></li> <li><a href="/scala-server-toolkit/subprojects/cassandra-datastax-driver" class="">Datastax Cassandra Driver</a></li> <li><a href="/scala-server-toolkit/subprojects/fs2-kafka" class=" active ">FS2 Kafka</a></li> <li><a href="/scala-server-toolkit/subprojects/ssl-config" class="">SSL Config</a></li> <li><a href="/scala-server-toolkit/subprojects/doobie" class="">doobie</a></li> <li><a href="/scala-server-toolkit/subprojects/flyway" class="">Flyway</a></li> <li><a href="/scala-server-toolkit/subprojects/monix-catnap" class="">monix-catnap - Circuit Breaker</a></li> <li><a href="/scala-server-toolkit/subprojects/sentry" class="">Sentry</a></li> <li><a href="/scala-server-toolkit/subprojects/lettuce" class="">Lettuce (Redis)</a></li></ul></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li class="search-nav hidden-xs hidden-sm"><div id="search-dropdown"><label><i class="fa fa-search"></i>Search</label><input id="search-bar" type="text" placeholder="Enter keywords here..." onclick="displayToggleSearch(event)" /><ul id="search-dropdown-content" class="dropdown dropdown-content"></ul></div></li><li id="gh-eyes-item" class="hidden-xs to-uppercase"><a href="https://github.com/avast/scala-server-toolkit" target="_blank" rel="noopener noreferrer"><i class="fa fa-eye"></i><span>Watchers<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs to-uppercase"><a href="https://github.com/avast/scala-server-toolkit" target="_blank" rel="noopener noreferrer"><i class="fa fa-star-o"></i><span>Stars<span id="stars" class="label label-default">--</span></span></a></li></ul></div></div></div></div><div id="content" data-github-owner="avast" data-github-repo="scala-server-toolkit"><div class="content-wrapper"><section><h1 id="fs2-kafka">FS2 Kafka</h1>

<p><code class="highlighter-rouge">libraryDependencies += "com.avast" %% "sst-fs2-kafka" % "0.18.4"</code></p>

<p>This subproject initializes <a href="https://github.com/fd4s/fs2-kafka">FS2 Kafka</a> consumer or producer:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">cats.effect.Resource</span>
<span class="k">import</span> <span class="nn">cats.syntax.flatMap.</span><span class="o">*</span>
<span class="k">import</span> <span class="nn">com.avast.sst.fs2kafka.</span><span class="o">*</span>
<span class="k">import</span> <span class="nn">fs2.kafka.</span><span class="o">{</span><span class="nc">AutoOffsetReset</span><span class="o">,</span> <span class="nc">ProducerRecord</span><span class="o">,</span> <span class="nc">ProducerRecords</span><span class="o">}</span>
<span class="k">import</span> <span class="nn">zio.</span><span class="o">*</span>
<span class="k">import</span> <span class="nn">zio.interop.catz.</span><span class="o">*</span>
<span class="k">import</span> <span class="nn">zio.interop.catz.implicits.</span><span class="o">*</span>

<span class="k">implicit</span> <span class="k">val</span> <span class="nv">runtime</span><span class="k">:</span> <span class="kt">Runtime</span><span class="o">[</span><span class="kt">ZEnv</span><span class="o">]</span> <span class="k">=</span> <span class="nv">zio</span><span class="o">.</span><span class="py">Runtime</span><span class="o">.</span><span class="py">default</span> <span class="c1">// this is just needed in example</span>

<span class="k">for</span> <span class="o">{</span>
  <span class="n">consumer</span> <span class="k">&lt;-</span> <span class="nv">Fs2KafkaModule</span><span class="o">.</span><span class="py">makeConsumer</span><span class="o">[</span><span class="kt">Task</span>, <span class="kt">String</span>, <span class="kt">String</span><span class="o">](</span>
    <span class="nc">ConsumerConfig</span><span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="s">"localhost:9092"</span><span class="o">),</span> <span class="n">groupId</span> <span class="k">=</span> <span class="s">"test"</span><span class="o">,</span> <span class="n">autoOffsetReset</span> <span class="k">=</span> <span class="nv">AutoOffsetReset</span><span class="o">.</span><span class="py">Earliest</span><span class="o">),</span> <span class="nc">None</span><span class="o">,</span> <span class="nc">None</span>
  <span class="o">)</span>
  <span class="k">_</span> <span class="k">&lt;-</span> <span class="nv">Resource</span><span class="o">.</span><span class="py">eval</span><span class="o">(</span><span class="nv">consumer</span><span class="o">.</span><span class="py">subscribeTo</span><span class="o">(</span><span class="s">"test"</span><span class="o">))</span>
  <span class="n">consumerStream</span> <span class="k">&lt;-</span> <span class="nv">Resource</span><span class="o">.</span><span class="py">eval</span><span class="o">(</span><span class="nv">consumer</span><span class="o">.</span><span class="py">stream</span><span class="o">)</span>
<span class="o">}</span> <span class="k">yield</span> <span class="n">consumerStream</span>
</code></pre></div></div>

<p>The configuration of Kafka client is very large therefore you can either use the provided configuration case class, or you can use the underlying
<code class="highlighter-rouge">ConsumerSettings</code>/<code class="highlighter-rouge">ProducerSettings</code> builders directly.</p>

<p>The configuration case classes contain an “escape hatch” into the full world of Kafka client configuration options via untyped properties.
This is there to be flexible in case it is needed. Documentation of all the configuration properties is available here:</p>
<ul>
  <li><a href="http://kafka.apache.org/documentation/#consumerconfigs">consumer</a></li>
  <li><a href="http://kafka.apache.org/documentation/#producerconfigs">producer</a></li>
</ul>

<p>Beware that there is an optional dependency on <code class="highlighter-rouge">jackson-databind</code> for the default implementation of <code class="highlighter-rouge">SASL/OAUTHBEARER</code> in <code class="highlighter-rouge">kafka-clients</code>.
You need to provide it explicitly: https://kafka.apache.org/documentation/#security_sasl_oauthbearer_clientconfig</p>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/scala-server-toolkit/highlight/highlight.pack.js"></script><script src="/scala-server-toolkit/lunr/lunr.js"></script><script>
// For all code blocks, copy the language from the containing div
// to the inner code tag (where hljs expects it to be)
const langPrefix = 'language-';
document.querySelectorAll(`div[class^='${langPrefix}']`).forEach(function(div) {
  div.classList.forEach(function(cssClass) {
    if (cssClass.startsWith(langPrefix)) {
      const lang = cssClass.substring(langPrefix.length);
      div.querySelectorAll('pre code').forEach(function(code) {
        code.classList.add(lang);
      });
    }
  });
});

hljs.configure({languages:['scala','java','bash']});
hljs.initHighlightingOnLoad();
      </script><script>console.info('\x57\x65\x62\x73\x69\x74\x65\x20\x62\x75\x69\x6c\x74\x20\x77\x69\x74\x68\x3a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x5f\x20\x20\x20\x20\x5f\x5f\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x20\x5f\x5f\x0a\x20\x20\x20\x5f\x5f\x5f\x5f\x5f\x2f\x20\x2f\x5f\x20\x20\x2f\x20\x2f\x5f\x20\x20\x20\x20\x20\x20\x5f\x5f\x5f\x5f\x20\x5f\x5f\x5f\x20\x20\x28\x5f\x29\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x20\x20\x5f\x5f\x5f\x5f\x5f\x28\x5f\x29\x20\x2f\x5f\x5f\x5f\x5f\x20\x20\x5f\x5f\x5f\x5f\x5f\x0a\x20\x20\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x5c\x2f\x20\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x60\x5f\x5f\x20\x5c\x2f\x20\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x5c\x2f\x20\x5f\x5f\x5f\x2f\x20\x2f\x20\x5f\x5f\x2f\x20\x5f\x20\x5c\x2f\x20\x5f\x5f\x5f\x2f\x0a\x20\x28\x5f\x5f\x20\x20\x29\x20\x2f\x5f\x2f\x20\x2f\x20\x2f\x5f\x2f\x5f\x5f\x5f\x5f\x5f\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x5f\x5f\x2f\x20\x2f\x20\x20\x2f\x20\x2f\x5f\x2f\x20\x28\x5f\x5f\x20\x20\x29\x20\x2f\x20\x2f\x5f\x2f\x20\x20\x5f\x5f\x28\x5f\x5f\x20\x20\x29\x0a\x2f\x5f\x5f\x5f\x5f\x2f\x5f\x2e\x5f\x5f\x5f\x2f\x5c\x5f\x5f\x2f\x20\x20\x20\x20\x20\x2f\x5f\x2f\x20\x2f\x5f\x2f\x20\x2f\x5f\x2f\x5f\x2f\x5c\x5f\x5f\x5f\x2f\x5f\x2f\x20\x20\x20\x5c\x5f\x5f\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x2f\x5f\x2f\x5c\x5f\x5f\x2f\x5c\x5f\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x2f\x0a\x0a\x68\x74\x74\x70\x73\x3a\x2f\x2f\x34\x37\x64\x65\x67\x2e\x67\x69\x74\x68\x75\x62\x2e\x69\x6f\x2f\x73\x62\x74\x2d\x6d\x69\x63\x72\x6f\x73\x69\x74\x65\x73')</script><script src="/scala-server-toolkit/js/search.js"></script><script src="/scala-server-toolkit/js/main.js"></script></body></html>